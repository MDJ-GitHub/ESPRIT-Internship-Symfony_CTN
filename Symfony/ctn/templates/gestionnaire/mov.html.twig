{% extends 'base.html.twig' %}

{% block title %}
	CTN - Gestionnaire
{% endblock %}

{% block body %}
<nav class="navbar shadow-lg navbar-expand-lg navbar-dark bg-dark justify-content-between fixed-top">
	<img src="{{ asset('img/logo.png') }}" alt="Logo" style="max-width: 200px;"/>

	<a class="navbar-brand" href="#">Gestion des Mouvements</a>
	<form class="form-inline">
		<button class="btn btn-light my-2 my-sm-0" id="currentDateTime" type="button"></button>
		-
		<button class="btn btn-light my-2 my-sm-0" type="button">‚öì
			{{ loginnavire }}</button>
		-
		<div class="dropdownx">
			<button class="btn btn-light my-2 my-sm-0" type="button">üßë‚Äçüíº
				{{ loginnom }}</button>
			-
			<div class="dropdown-contentx">
				<a href="{{ path('app_logout') }}" class="btn btn-outline-danger my-2 my-sm-0" type="button">‚õî D√©connecter
				</a>
			</div>
		</div>
	</form>
</nav>

<div class="container-fluid">
	<div class="row">
		<nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-dark bg-opacity-75 sidebar">
			<div class="position-sticky">
				<br>
				<br>
				<ul class="nav nav-pills flex-column mb-auto">

					<li class="nav-item">
						<div class="text-white container mt-5 bg-secondary text-center border border-5 border-secondary rounded">

							<form action={{url('app_gestionnaire_movf')}}>
								<div class="form-group">
									<label for="nom">Navigant</label>
									<input type="text" class="form-control form-control-sm" id="nom" name="navigant" value="{{ filn }}" placeholder="Pr√©nom et Nom">
								</div>
								<div class="row">
									<div class="col">
										<div class="form-group">
											<label for="dropdown1">Port Dep.</label>
											<select class="form-control form-control-sm" name="portdep" id="dropdown1">
												<option>Tout</option>
												<option {% if filpdep == 'Bizerte' %} selected {% endif %}>Bizerte</option>
												<option {% if filpdep == 'Rades' %} selected {% endif %}>Rades</option>
												<option {% if filpdep == 'Sousse' %} selected {% endif %}>Sousse</option>
												<option {% if filpdep == 'Sfax' %} selected {% endif %}>Sfax</option>
												<option {% if filpdep == 'Gabes' %} selected {% endif %}>Gabes</option>
												<option {% if filpdep == 'Goulette' %} selected {% endif %}>Goulette</option>
												<option {% if filpdep == 'Zarzis' %} selected {% endif %}>Zarzis</option>
											</select>
										</div>
									</div>
									<div class="col">
										<div class="form-group">
											<label for="dropdown2">Port Dea.</label>
											<select class="form-control form-control-sm" name="portdes" id="dropdown2">
												<option>Tout</option>
												<option {% if filpdes == 'Bizerte' %} selected {% endif %}>Bizerte</option>
												<option {% if filpdes == 'Rades' %} selected {% endif %}>Rades</option>
												<option {% if filpdes == 'Sousse' %} selected {% endif %}>Sousse</option>
												<option {% if filpdes == 'Sfax' %} selected {% endif %}>Sfax</option>
												<option {% if filpdes == 'Gabes' %} selected {% endif %}>Gabes</option>
												<option {% if filpdes == 'Goulette' %} selected {% endif %}>Goulette</option>
												<option {% if filpdes == 'Zarzis' %} selected {% endif %}>Zarzis</option>
											</select>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="col">
										<div class="form-group">
											<label for="dropdown3">Situation</label>
											<select class="form-control form-control-sm" name="situation" id="dropdown3">
												<option>Tout</option>
												<option {% if fils == 'Titulaire' %} selected {% endif %}>Titulaire</option>
												<option {% if fils == 'Contractuel' %} selected {% endif %}>Contractuel</option>
												<option {% if fils == 'Occasionnel' %} selected {% endif %}>Occasionnel</option>

											</select>
										</div>
									</div>
									<div class="col">
										<div class="form-group">
											<label for="fonction">Fonction</label>
											<select class="form-control form-control-sm" id="fonction" name="fonction">
												<option>Tout</option>
												<option value="Standard" {% if filf == 'Standard' %} selected {% endif %}>Standard</option>
												<option value="Gestionnaire" {% if filf == 'Gestionnaire' %} selected {% endif %}>Gestionnaire</option>
												<option value="Commandant" {% if filf == 'Commandant' %} selected {% endif %}>Commandant</option>
												<option value="G. Utilisateur" {% if filf == 'G. Utilisateur' %} selected {% endif %}>G. Utilisateur</option>
												<option value="Capitaine" {% if filf == 'Capitaine' %} selected {% endif %}>Capitaine</option>
												<option value="Gar√ßon" {% if filf == 'Gar√ßon' %} selected {% endif %}>Gar√ßon</option>
												<option value="Mecanician" {% if filf == 'Mecanician' %} selected {% endif %}>Mecanician</option>
												<option value="Medicain" {% if filf == 'Medicain' %} selected {% endif %}>Medicain</option>

											</select>
										</div>
									</div>
								</div>


								<div class="form-group">
									<label for="etat">Etat</label>
									<select class="form-control form-control-sm" name="etat" id="etat">
										<option>Tout</option>
										<option {% if file == 'Programm√©' %} selected {% endif %}>Programm√©</option>
										<option {% if file == 'Absant' %} selected {% endif %}>Absant</option>
										<option {% if file == 'Annul√©' %} selected {% endif %}>Annul√©</option>
										<option {% if file == 'Embarqu√©' %} selected {% endif %}>Embarqu√©</option>
										<option {% if file == 'Debarqu√©' %} selected {% endif %}>Debarqu√©</option>
										<option {% if file == 'Evalu√©' %} selected {% endif %}>Evalu√©</option>
										<option {% if file == 'Inconnu' %} selected {% endif %}>Inconnu</option>

									</select>
								</div>


								<div class="row">
									<div class="col">
										<div class="form-group">
											<button type="submit" name="a" value="a" class="btn btn-sm btn-danger mt-3">Filtrer</button>
										</div>
									</div>
									<div class="col">
										<div class="form-group">


											<button type="submit" name="a" value="b" class="btn btn-sm btn-danger mt-3">Effacer</button>

										</div>
									</div>
								</div>
							</form>
						</div>
					</li>


					<li class="">
						<div class="text-white container mt-3 bg-secondary text-center border border-5 border-secondary rounded">
							G√©n√©rer
							<form>

								<a href="{{ path('app_gestionnaire_pdf', { 'n': filn | default(' '), 'f': filf, 'pdep': filpdep, 'pdes': filpdes, 's': fils, 'e': file }) }}" class="btn btn-danger btn-sm" type="button">PDF</a>


								<a href="{{ path('app_gestionnaire_csv', { 'n': filn | default(' '), 'f': filf, 'pdep': filpdep, 'pdes': filpdes, 's': fils, 'e': file }) }}" class="btn btn-danger btn-sm" type="button">CSV</a>


							</form>
						</div>
					</li>

					<hr style="color:white;">
					<li class="nav-item">
						<a href="{{ path('app_gestionnaire') }}" class="nav-link text-white" aria-current="page">
							<svg class="bi me-2" width="0" height="16">
								<use xlink:href="#home"></use>
							</svg>üßë‚Äçüßí‚Äçüßí Personnels
						</a>
					</li>
					<li>
						<a href="{{ path('app_gestionnaire_mov') }}" class="nav-link bg-danger text-white">
							<svg class="bi me-2" width="0" height="16">
								<use xlink:href="#speedometer2"></use>
							</svg>‚õµ Mouvements
						</a>
					</li>
					<li>
						<a href="{{ path('app_gestionnaire_evaa') }}" class="nav-link text-white">
							<svg class="bi me-2" width="0" height="16">
								<use xlink:href="#speedometer2"></use>
							</svg>üìù Evaluations
						</a>
					</li>
				</ul>

			</div>
		</nav>

		<main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
			<br>
			<br>
			<br>

			
			<div class="table-container">
				<table class="table table-striped">
					<thead class="thead-dark">
						<tr>
							<th scope="col">Mat</th>
							<th scope="col">Navigant</th>
							<th scope="col">Date Emb. Atte/Conf</th>
							<th scope="col">Date Deb. Atte/Conf</th>
							<th scope="col">Port Dep.</th>
							<th scope="col">Port Des.</th>
							<th scope="col">Fn</th>
							<th scope="col">Navire</th>
							<th scope="col">Situation</th>
							<th scope="col">Ac</th>
							<th class="bg-secondary" scope="col">Etat</th>
						</tr>
					</thead>
					<tbody>
						{% for i in list %}
							<form action={{url('app_gestionnaire_deb',{'mat':i.getId()} )}}>
								<tr>
									<th scope="row">{{ i.getId() }}</th>
									<td>{{ i.matriculep.getPrenom() }}
										{{ i.matriculep.getNom() }}</td>
									<td>{{ i.getDateemb()|date('Y-m-d') }}
										<hr style="margin: 5px 0;
																																																																																																																																																																																																																																																																																																	        padding: 0;    ">
										{% if i.getEtat() == 'Embarqu√©' %}
											{{ i.getDateembc()|date('Y-m-d') }}

										{% elseif i.getEtat() == 'Evalu√©' %}
											{{ i.getDateembc()|date('Y-m-d') }}

										{% elseif i.getEtat() == 'Debarqu√©' %}
											{{ i.getDateembc()|date('Y-m-d') }}

										{% elseif  i.getEtat() == 'Programm√©' %}
											<input type="date" class="form-control" value="{{ i.getDateembc()|date('Y-m-d') }}" name="dateemb" id="dateInput">


										{% elseif 'Annul√©' in i.getEtat()  %}
											<input type="date" class="form-control" value="{{ i.getDateembc()|date('Y-m-d') }}" name="dateemb" id="dateInput">

										{% elseif 'Absant' in i.getEtat()  %}
											<input type="date" class="form-control" value="{{ i.getDateembc()|date('Y-m-d') }}" name="dateemb" id="dateInput">

											{% else %}
										{% endif %}
									</td>
									<td>
										{% if i.getDatedeb() is null %}
											---
										{% else %}

											{{ i.getDatedeb()|date('Y-m-d') }}
										{% endif %}
										<hr style="margin: 5px 0;
																																																																																																																																																																																																																																																																																											        padding: 0;    ">
										{% if i.getEtat() == 'Embarqu√©' %}

											<input type="date" class="form-control" value="{{ i.getDatedebc()|date('Y-m-d') }}" name="datedeb" id="dateInput">


										{% elseif i.getEtat() == 'Evalu√©' %}
											{{ i.getDatedebc()|date('Y-m-d') }}

										{% elseif i.getEtat() == 'Debarqu√©' %}
											{{ i.getDatedebc()|date('Y-m-d') }}
										{% elseif  i.getEtat() == 'Programm√©' %}
											---

										{% elseif 'Annul√©' in i.getEtat()  %}
											---
										{% elseif 'Absant' in i.getEtat()  %}
											---
											{% else %}

										{% endif %}
									</td>

									<td>{{ i.getPortdep() }}</td>
									<td>{{ i.getPortdes() }}</td>
									<td>{{ i.matriculep.getFonction() }}</td>
									<td>{{ i.matriculep.getNavire() }}</td>
									<td>{{ i.getSituation() }}</td>
									<td>
										<div class="dropdown">
											üî¥
											<div class="dropdown-content">
												{% if i.getEtat() == 'Embarqu√©' %}
													<button value="b" class="btn btn-outline-danger my-2 my-sm-0 btn-sm" name="action" type="submit">‚úÖ Evaluer
													</button>
													<br>
													<button value="a" class="btn btn-outline-danger my-2 my-sm-0 btn-sm" name="action" type="submit">‚úîÔ∏è D√©barquer
													</button>
												{% elseif i.getEtat() == 'Evalu√©' %}
													<button value="b" class="btn btn-outline-danger my-2 my-sm-0 btn-lg" name="action" type="submit">‚úÖ Revaluer
													</button>
												{% elseif i.getEtat() == 'Debarqu√©' %}
													<button value="b" class="btn btn-outline-danger my-2 my-sm-0 btn-lg" name="action" type="submit">‚úÖ Evaluer
													</button>
												{% elseif  i.getEtat() == 'Programm√©' %}
													<button value="c" class="btn btn-outline-danger my-2 my-sm-0 btn-sm" name="action" type="submit">‚ùóAnnuler
													</button>
													<br>
													<button value="e" class="btn btn-outline-danger my-2 my-sm-0 btn-sm" name="action" type="submit">‚≠ï Embarquer
													</button>
													<br>
													<button value="d" class="btn btn-outline-danger my-2 my-sm-0 btn-sm" name="action" type="submit">‚ùå Absent
													</button>
												{% elseif 'Annul√©' in i.getEtat()  %}
													<button value="d" class="btn btn-outline-danger my-2 my-sm-0 btn-sm" name="action" type="submit">‚ùå Absent
													</button>
													<br>
													<button value="e" class="btn btn-outline-danger my-2 my-sm-0 btn-sm" name="action" type="submit">‚≠ï Embarquer
													</button>
												{% elseif 'Absant' in i.getEtat()  %}
													<button value="c" class="btn btn-outline-danger my-2 my-sm-0 btn-sm" name="action" type="submit">‚ùóAnnuler
													</button>
													<br>
													<button value="e" class="btn btn-outline-danger my-2 my-sm-0 btn-sm" name="action" type="submit">‚≠ï Embarquer
													</button>
													{% else %}
												{% endif %}
											</div>
										</div>
									</td>

									{% if i.getEtat() == 'Embarqu√©' %}
										<td class="bg-primary text-white">{{i.getEtat()}}</td>
									{% elseif i.getEtat() == 'Evalu√©' %}
										<td class="bg-success text-white">{{i.getEtat()}}</td>
									{% elseif i.getEtat() == 'Debarqu√©' %}
										<td class="bg-success text-white">{{i.getEtat()}}</td>
									{% elseif  i.getEtat() == 'Programm√©' %}
										<td class="bg-warning">{{i.getEtat()}}</td>
									{% elseif 'Annul√©' in i.getEtat()  %}
										<td class="bg-danger text-white">{{i.getEtat()}}</td>
									{% elseif 'Absent' in i.getEtat()  %}
										<td class="bg-danger text-white">{{i.getEtat()}}</td>
									{% elseif i.getEtat() == ''  %}
										<td class="bg-secondary text-white">Inconnu</td>
									{% else %}
										<td class="bg-info">{{i.getEtat()}}</td>
									{% endif %}
								</tr>


							</form>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</main>
	</div>
</div>
<style>
	.table-container {
		max-height: calc(100vh - 80px); /* Adjust the maximum height as needed */
		overflow-y: auto; /* Add vertical scroll for the content */
	}

	.table thead {
		position: sticky;
		top: 0;
		z-index: 1; /* Ensure the header is above the table content */
	}

	#sidebar {
		min-height: 100vh; /* Set the sidebar's minimum height to 100% of the viewport height */
		position: fixed;
	}
	body {
		background-image: url({{ asset('img/background.png') }}); /* Replace with the actual path to your hiba image */
		background-size: cover; /* This will make the image cover the entire background */
		background-repeat: no-repeat; /* Prevent the image from repeating */
	}
	table tr td,
	table tr th {
		background-color: rgba(255, 255, 255, 0.6) !important;
	}

	.dropdown {
		position: relative;
		display: inline-block;
	}

	.dropdown-content {
		display: none;
		position: absolute;
		background-color: #f9f9f9;

		box-shadow: 0 8px 16px 0 rgba(10, 0, 0, 0.2);
		z-index: 1;
	}

	.dropdown:hover .dropdown-content {
		display: flex; /* Use flexbox to make them appear in the same row */
		flex-direction: row; /* Arrange them horizontally */
		top: -10px; /* Position below the dropdown button */
		left: -110px; /* Align with the left edge of the dropdown button */
	}
	.dropdownx {
		position: relative;
		display: inline-block;
	}

	.dropdown-contentx {
		display: none;
		position: absolute;
		background-color: #f9f9f9;

		box-shadow: 0 8px 16px 0 rgba(10, 0, 0, 0.2);
		z-index: 1;
	}

	.dropdownx:hover .dropdown-contentx {
		display: flex; /* Use flexbox to make them appear in the same row */
		flex-direction: column; /* Arrange them horizontally */
		/* Position below the dropdown button */
		/* Align with the left edge of the dropdown button */
	}
</style>
<script>function updateCurrentDateTime() {
																																														var now = new Date()
																																														var year = now.getFullYear()
																																														var month = String(now.getMonth() + 1).padStart(2, '0')
																																														var day = String(now.getDate()).padStart(2, '0')
																																														var hour = String(now.getHours()).padStart(2, '0')
																																														var minute = String(now.getMinutes()).padStart(2, '0')
																																														var second = String(now.getSeconds()).padStart(2, '0')
																																														
																																														var currentDateTime = 'üïê ' + year + '-' + month + '-' + day + ' ' + hour + ':' + minute + ':' + second
																																														
																																														document.getElementById('currentDateTime').textContent = currentDateTime
																																														}
																																														
																																														// Update the current date and time immediately and then update it every minute
																																														updateCurrentDateTime()
																																														setInterval(updateCurrentDateTime, 1000) // Update every 1 minute (60000 milliseconds)</script>{% endblock %}
